<#
.SYNOPSIS
Retrieves the list of tenants groups.

.DESCRIPTION
The Get-CIPPTenantGroups function retrieves a list of tenant groups from CIPP.

.EXAMPLE
Get-CIPPTenantGroups
Retrieves the list of current tenants groups.

#>

function Get-CIPPTenantGroups {
    [CmdletBinding()]
    Param()

    Write-Verbose 'Getting Tenant Groups List'

    $endpoint = '/api/listtenantgroups'

    $request = Invoke-CIPPRestMethod -Endpoint $endpoint -Method GET

    # Convert the result to a more friendly PowerShell object
    if ($request) {
        foreach ($result in $request.results){
            [PSCustomObject]@{
                TenantGroupID     = $result.Id
                Name              = $result.Name
                Description       = $result.Description
                Members           = $result.Members
            }
        }
    } else {
        Write-Warning 'No tenant groups found'
        $null
    }
        
}
